# F3.T1: GA Engine Core

## Agent: DOTNET_SENIOR

## Task Overview
Implement the core genetic algorithm engine that manages population evolution through generations.

## Context
Create new project `src/TzarBot.GeneticAlgorithm/`.

## Requirements

1. Create project with dependencies:
   - Reference TzarBot.NeuralNetwork
   - Reference TzarBot.Common

2. Create configuration:
   ```csharp
   public class GAConfig
   {
       public int PopulationSize { get; set; } = 100;
       public int EliteCount { get; set; } = 5;
       public float CrossoverRate { get; set; } = 0.7f;
       public float MutationRate { get; set; } = 0.2f;
       public float WeightMutationStrength { get; set; } = 0.1f;
       public float StructureMutationRate { get; set; } = 0.05f;
       public int TournamentSize { get; set; } = 3;
       public int MaxGenerations { get; set; } = 1000;
       public bool PreserveParents { get; set; } = false;
   }
   ```

3. Create Population class:
   ```csharp
   public class Population
   {
       public int Generation { get; private set; }
       public List<NetworkGenome> Individuals { get; }
       public NetworkGenome BestGenome => Individuals.MaxBy(g => g.Fitness);
       public float AverageFitness => Individuals.Average(g => g.Fitness);
       public float MaxFitness => Individuals.Max(g => g.Fitness);
       public float MinFitness => Individuals.Min(g => g.Fitness);
       public float FitnessStdDev { get; }

       public void AdvanceGeneration();
       public void UpdateFitness(Guid genomeId, float fitness);
       public IEnumerable<NetworkGenome> GetElites(int count);
   }
   ```

4. Create interface:
   ```csharp
   public interface IGeneticAlgorithm
   {
       Population CurrentPopulation { get; }
       int CurrentGeneration { get; }
       NetworkGenome BestGenome { get; }

       void Initialize(int inputWidth, int inputHeight);
       void EvolveNextGeneration();
       void SetFitness(Guid genomeId, float fitness);

       event Action<GenerationStats>? OnGenerationComplete;
   }
   ```

5. Implement `GeneticAlgorithmEngine`

6. Create statistics class:
   ```csharp
   public class GenerationStats
   {
       public int Generation { get; set; }
       public float BestFitness { get; set; }
       public float AverageFitness { get; set; }
       public float StdDevFitness { get; set; }
       public float Diversity { get; set; }
       public int UniqueStructures { get; set; }
       public TimeSpan GenerationTime { get; set; }
   }
   ```

7. Create tests:
   - Test_Initialize_CreatesPopulation
   - Test_EvolveGeneration_IncreasesCounter
   - Test_Elitism_PreservesBest
   - Test_SetFitness_UpdatesGenome
   - Test_Statistics_CalculatedCorrectly

## Outputs
- `src/TzarBot.GeneticAlgorithm/TzarBot.GeneticAlgorithm.csproj`
- `src/TzarBot.GeneticAlgorithm/Core/IGeneticAlgorithm.cs`
- `src/TzarBot.GeneticAlgorithm/Core/GeneticAlgorithmEngine.cs`
- `src/TzarBot.GeneticAlgorithm/Core/Population.cs`
- `src/TzarBot.GeneticAlgorithm/Core/GAConfig.cs`
- `tests/TzarBot.Tests/Phase3/GAEngineTests.cs`

## Test Command
```bash
dotnet test tests/TzarBot.Tests --filter "FullyQualifiedName~Phase3.GAEngine"
```
