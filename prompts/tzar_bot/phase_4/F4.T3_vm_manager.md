# F4.T3: VM Manager Service

## Agent: DOTNET_SENIOR

## Task Overview
Implement C# wrapper for Hyper-V management via PowerShell.

## Context
Create new project `src/TzarBot.Infrastructure/`.

## Requirements

1. Create interface:
   ```csharp
   public interface IVMManager
   {
       Task<IEnumerable<VMInfo>> GetWorkersAsync();
       Task<VMInfo> CreateWorkerAsync(int workerNumber);
       Task RemoveWorkerAsync(int workerNumber);
       Task StartWorkerAsync(int workerNumber);
       Task StopWorkerAsync(int workerNumber);
       Task<bool> IsWorkerReadyAsync(int workerNumber);
       Task WaitForWorkerReadyAsync(int workerNumber, CancellationToken ct);
   }

   public class VMInfo
   {
       public string Name { get; set; }
       public int WorkerNumber { get; set; }
       public string IPAddress { get; set; }
       public VMState State { get; set; }
       public long MemoryMB { get; set; }
       public int CPUUsage { get; set; }
   }

   public enum VMState
   {
       Off, Starting, Running, Stopping, Saved, Paused
   }
   ```

2. Implement `HyperVManager`:
   - Execute PowerShell scripts
   - Parse output to C# objects
   - Handle errors gracefully
   - Implement retry logic

3. Implement `PowerShellExecutor`:
   - Run PowerShell commands
   - Capture stdout/stderr
   - Parse PSObject results
   - Timeout handling

4. Create tests:
   - Test_GetWorkers_ReturnsVMs
   - Test_CreateWorker_CreatesVM
   - Test_StopWorker_StopsVM
   - Test_WaitForReady_TimesOut

## Outputs
- `src/TzarBot.Infrastructure/TzarBot.Infrastructure.csproj`
- `src/TzarBot.Infrastructure/VMs/IVMManager.cs`
- `src/TzarBot.Infrastructure/VMs/HyperVManager.cs`
- `src/TzarBot.Infrastructure/VMs/VMInfo.cs`
- `src/TzarBot.Infrastructure/PowerShell/PowerShellExecutor.cs`
- `tests/TzarBot.Tests/Phase4/VMManagerTests.cs`

## Test Command
```bash
dotnet test tests/TzarBot.Tests --filter "FullyQualifiedName~Phase4.VMManager"
```
