# Task F1.T5: Window Detection Implementation

## Task ID
`F1.T5`

## Description
Implement detection and tracking of the Tzar game window using Win32 API.

## Prerequisites
- F1.T1 (Project Setup) completed

## Instructions

### Step 1: Create WindowInfo

Create `src/TzarBot.GameInterface/Window/WindowInfo.cs`:

```csharp
namespace TzarBot.GameInterface.Window;

public class WindowInfo
{
    public required IntPtr Handle { get; init; }
    public required string Title { get; init; }
    public required string ClassName { get; init; }
    public required Rectangle Bounds { get; init; }
    public required Rectangle ClientBounds { get; init; }
    public required bool IsFocused { get; init; }
    public required bool IsMinimized { get; init; }
    public required bool IsVisible { get; init; }
}
```

### Step 2: Create IWindowDetector Interface

Create `src/TzarBot.GameInterface/Window/IWindowDetector.cs`:

```csharp
namespace TzarBot.GameInterface.Window;

public interface IWindowDetector
{
    WindowInfo? FindWindow(string titlePattern);
    WindowInfo? FindWindowByClass(string className);
    WindowInfo? FindWindowByProcess(string processName);
    WindowInfo? GetWindowInfo(IntPtr handle);
    bool SetForeground(IntPtr handle);
    IEnumerable<WindowInfo> EnumerateWindows();
}
```

### Step 3: Implement WindowDetector

Create `src/TzarBot.GameInterface/Window/WindowDetector.cs`:

Use P/Invoke for:
- FindWindow / FindWindowEx
- GetWindowRect / GetClientRect
- GetWindowText
- IsWindowVisible, IsIconic
- GetForegroundWindow
- SetForegroundWindow
- EnumWindows

### Step 4: Add Tzar-specific Constants

```csharp
public static class TzarWindow
{
    public const string WindowTitle = "Tzar";
    public const string ProcessName = "Tzar";
}
```

### Step 5: Create Tests

Create `tests/TzarBot.Tests/Phase1/WindowDetectorTests.cs`.

## Expected Output Files
- `src/TzarBot.GameInterface/Window/IWindowDetector.cs`
- `src/TzarBot.GameInterface/Window/WindowDetector.cs`
- `src/TzarBot.GameInterface/Window/WindowInfo.cs`
- `tests/TzarBot.Tests/Phase1/WindowDetectorTests.cs`

## Validation
```bash
dotnet test tests/TzarBot.Tests --filter "FullyQualifiedName~Phase1.WindowDetector"
```

---
*Prompt for TzarBot Phase 1, Task 5*
